(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3f896856"],{"4de4":function(t,e,n){"use strict";var a=n("23e7"),s=n("b727").filter,i=n("1dde"),r=n("ae40"),o=i("filter"),c=r("filter");a({target:"Array",proto:!0,forced:!o||!c},{filter:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}})},5468:function(t,e,n){},5530:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));n("a4d3"),n("4de4"),n("4160"),n("e439"),n("dbb4"),n("b64b"),n("159b");function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}},"5dfd":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"order-detail-page"},[n("Header"),n("div",{staticClass:"page-title"},[n("span",{staticClass:"orange-mark pointer",on:{click:function(e){return t.$goto("/production")}}},[t._v("产品")]),t._v(" > 订单详情 ")]),n("div",{staticClass:"content-panel"},[n("div",{staticClass:"product-list"},t._l(t.productList,(function(e){return n("div",{key:e.id,staticClass:"product-item"},[n("div",{staticClass:"cube name"},[t._v(t._s(e.type&&e.type.product_type_name||""))]),n("div",{staticClass:"cube"},[e.specs?n("span",[t._v(t._s(e.specs))]):t._e(),e.rate?n("span",[t._v(t._s(e.rate))]):t._e()]),n("div",{staticClass:"cube"},[e.price?n("span",[t._v("单价："+t._s(e.total_price)+" 元")]):t._e()]),n("div",{staticClass:"cube"},[e.price?n("div",{staticClass:"amount-selector"},[n("span",{class:["minus-btn",1==e.amount?"disable":""],on:{click:function(n){return t.handleReduce(e)}}},[n("a-icon",{attrs:{type:"minus"}})],1),n("a-input",{staticClass:"amount-input",on:{change:function(n){return t.handleAmountChange(e)}},model:{value:e.amount,callback:function(n){t.$set(e,"amount",n)},expression:"item.amount"}}),n("span",{class:["plus-btn",e.amount==e.stock?"disable":""],on:{click:function(n){return t.handleAdd(e)}}},[n("a-icon",{attrs:{type:"plus"}})],1)],1):t._e()]),n("div",{staticClass:"cube"},[e.price?n("div",[t._v(" 小计："),n("span",{staticClass:"total-price orange-mark"},[t._v("¥"+t._s(e.total_price*e.amount))])]):t._e()]),n("div",{staticClass:"cube delete-cube"},[e.price?n("span",{on:{click:function(n){return t.handleDelete(e)}}},[t._v("删除")]):t._e()])])})),0),n("div",{staticClass:"input-area"},[n("div",{staticClass:"address-panel"},[t._m(0),n("div",{staticClass:"input-row"},[n("div",{staticClass:"label"},[t._v("姓名")]),n("a-input",{attrs:{allowClear:"",maxLength:20},model:{value:t.info.express_name,callback:function(e){t.$set(t.info,"express_name",e)},expression:"info.express_name"}}),n("div",{staticClass:"label label-2"},[t._v("电话")]),n("a-input",{attrs:{allowClear:"",maxLength:20},model:{value:t.info.express_mobile,callback:function(e){t.$set(t.info,"express_mobile",e)},expression:"info.express_mobile"}})],1)])]),n("div",{staticClass:"computed-row"},[n("div",{staticClass:"total"},[t._v("总共配置费用："),n("span",{staticClass:"unit orange-mark"},[t._v("¥")]),n("span",{staticClass:"number orange-mark"},[t._v(t._s(t.totalFee))])]),n("a-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.submit}},[t._v("立即购买")])],1)]),n("Footer")],1)},s=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"title"},[t._v("收货人信息"),n("span",{staticClass:"orange-mark"},[t._v("下单后平台客服将用此电话联系您，请认真填写")])])}],i=(n("99af"),n("4de4"),n("4160"),n("d81d"),n("fb6a"),n("a9e3"),n("159b"),n("5530")),r=n("0418"),o=n("fd2d"),c=n("365c"),u=[{id:"feeId",type:{product_type_name:"技术服务费"},rate:"20%/年"}],l={name:"order-detail",components:{Header:r["a"],Footer:o["a"]},data:function(){return{loading:!1,amount:1,ids:void 0,productList:[],info:{express_name:void 0,express_mobile:void 0},totalFee:0}},created:function(){var t=this.$route.query.ids;if(!t)return this.$message.error("请先选择要购买的产品！"),void this.$router.push("/production");this.ids=t,this.render()},methods:{render:function(){var t=this;Object(c["m"])({ids:this.ids}).then((function(e){var n=(e.data||[]).concat(u);t.productList=n.map((function(t){return t.amount=1,t})),t.computeTotalFee()}))},submit:function(){var t=this;if(this.amount)if(this.info.express_name&&this.info.express_mobile)if(/^1[3456789]\d{9}$/.test(this.info.express_mobile)){var e=this.productList.filter((function(t){return t.total_price})).map((function(t){return{id:t.id,quantity:t.amount}}));this.loading=!0,Object(c["a"])(Object(i["a"])({info:e},this.info)).then((function(e){t.loading=!1,t.$message.success("购买成功！"),t.$router.push("/mine/order")})).catch((function(e){t.loading=!1,t.$message.error(e||"购买失败，请稍后再试！")}))}else this.$message.error("手机号不合法！");else this.$message.error("请输入收货人信息！");else this.$message.error("请输入购买的集群数量！")},handleDelete:function(t){if(2!==this.productList.length){var e=[];this.productList.forEach((function(n,a){String(n.id)!==String(t.id)&&e.push(n)})),this.productList=e,this.computeTotalFee()}else this.$message.error("至少要购买一个产品！")},computeTotalFee:function(){var t=0;this.productList.forEach((function(e){e.total_price&&(t+=e.total_price*Number(e.amount))})),this.totalFee=t},handleReduce:function(t){var e=Number(t.amount);t.amount=e-1>0?e-1:1,this.computeTotalFee()},handleAdd:function(t){t.stock&&Number(t.amount)+1>Number(t.stock)?t.amount=Number(t.stock):t.amount=Number(t.amount)+1,this.computeTotalFee()},handleAmountChange:function(t){var e=t.amount;/^[0-9]+$/.test(e)||(t.amount=e.slice(0,-1)),t.stock&&Number(e)>Number(t.stock)?t.amount=Number(t.stock):(Number(e)>1e7&&(t.amount=1e7),Number(e)<=0&&(t.amount=1),this.computeTotalFee())}}},d=l,p=(n("e4e7"),n("77c4"),n("2877")),m=Object(p["a"])(d,a,s,!1,null,"5aab0581",null);e["default"]=m.exports},"77c4":function(t,e,n){"use strict";n("5468")},d81d:function(t,e,n){"use strict";var a=n("23e7"),s=n("b727").map,i=n("1dde"),r=n("ae40"),o=i("map"),c=r("map");a({target:"Array",proto:!0,forced:!o||!c},{map:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}})},d958:function(t,e,n){},dbb4:function(t,e,n){var a=n("23e7"),s=n("83ab"),i=n("56ef"),r=n("fc6a"),o=n("06cf"),c=n("8418");a({target:"Object",stat:!0,sham:!s},{getOwnPropertyDescriptors:function(t){var e,n,a=r(t),s=o.f,u=i(a),l={},d=0;while(u.length>d)n=s(a,e=u[d++]),void 0!==n&&c(l,e,n);return l}})},e439:function(t,e,n){var a=n("23e7"),s=n("d039"),i=n("fc6a"),r=n("06cf").f,o=n("83ab"),c=s((function(){r(1)})),u=!o||c;a({target:"Object",stat:!0,forced:u,sham:!o},{getOwnPropertyDescriptor:function(t,e){return r(i(t),e)}})},e4e7:function(t,e,n){"use strict";n("d958")}}]);
//# sourceMappingURL=chunk-3f896856.16845bc8.js.map