(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-381e4f5f"],{"4de4":function(t,e,s){"use strict";var a=s("23e7"),n=s("b727").filter,r=s("1dde"),i=s("ae40"),o=r("filter"),c=i("filter");a({target:"Array",proto:!0,forced:!o||!c},{filter:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}})},5468:function(t,e,s){},5530:function(t,e,s){"use strict";s.d(e,"a",(function(){return r}));s("a4d3"),s("4de4"),s("4160"),s("e439"),s("dbb4"),s("b64b"),s("159b");function a(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function n(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function r(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?n(Object(s),!0).forEach((function(e){a(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):n(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}},"5dfd":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"order-detail-page"},[s("Header"),s("div",{staticClass:"page-title"},[s("span",{staticClass:"orange-mark pointer",on:{click:function(e){return t.$goto("/production")}}},[t._v("产品")]),t._v(" > 订单详情 ")]),s("div",{staticClass:"content-panel"},[s("div",{staticClass:"product-list"},t._l(t.productList,(function(e){return s("div",{key:e.id,staticClass:"product-item"},[s("div",{staticClass:"cube name"},[t._v(t._s(e.type&&e.type.product_type_name||""))]),s("div",{staticClass:"cube"},[e.specs?s("span",[t._v(t._s(e.specs))]):t._e(),e.rate?s("span",[t._v(t._s(e.rate))]):t._e()]),s("div",{staticClass:"cube"},[e.price?s("span",[t._v("单价："+t._s(e.total_price)+" 元")]):t._e()]),s("div",{staticClass:"cube"},[e.price?s("div",{staticClass:"amount-selector"},[s("span",{staticClass:"minus-btn",on:{click:function(s){return t.handleReduce(e)}}},[s("a-icon",{attrs:{type:"minus"}})],1),s("a-input",{staticClass:"amount-input",on:{change:function(s){return t.handleAmountChange(e)}},model:{value:e.amount,callback:function(s){t.$set(e,"amount",s)},expression:"item.amount"}}),s("span",{staticClass:"plus-btn",on:{click:function(s){return t.handleAdd(e)}}},[s("a-icon",{attrs:{type:"plus"}})],1)],1):t._e()]),s("div",{staticClass:"cube"},[e.price?s("div",[t._v(" 小计："),s("span",{staticClass:"total-price orange-mark"},[t._v("¥"+t._s(e.total_price*e.amount))])]):t._e()]),s("div",{staticClass:"cube delete-cube"},[e.price?s("span",{on:{click:function(s){return t.handleDelete(e)}}},[t._v("删除")]):t._e()])])})),0),s("div",{staticClass:"input-area"},[s("div",{staticClass:"address-panel"},[t._m(0),s("div",{staticClass:"input-row"},[s("div",{staticClass:"label"},[t._v("姓名")]),s("a-input",{attrs:{allowClear:"",maxLength:20},model:{value:t.info.express_name,callback:function(e){t.$set(t.info,"express_name",e)},expression:"info.express_name"}}),s("div",{staticClass:"label label-2"},[t._v("电话")]),s("a-input",{attrs:{allowClear:"",maxLength:20},model:{value:t.info.express_mobile,callback:function(e){t.$set(t.info,"express_mobile",e)},expression:"info.express_mobile"}})],1)])]),s("div",{staticClass:"computed-row"},[s("div",{staticClass:"total"},[t._v("总共配置费用："),s("span",{staticClass:"unit orange-mark"},[t._v("¥")]),s("span",{staticClass:"number orange-mark"},[t._v(t._s(t.totalFee))])]),s("a-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.submit}},[t._v("立即购买")])],1)]),s("Footer")],1)},n=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"title"},[t._v("收货人信息"),s("span",{staticClass:"orange-mark"},[t._v("下单后平台客服将用此电话联系您，请认真填写")])])}],r=(s("99af"),s("4de4"),s("4160"),s("d81d"),s("fb6a"),s("a9e3"),s("159b"),s("5530")),i=s("0418"),o=s("fd2d"),c=s("365c"),u=[{id:"feeId",type:{product_type_name:"技术服务费"},rate:"20%/年"}],l={name:"order-detail",components:{Header:i["a"],Footer:o["a"]},data:function(){return{loading:!1,amount:1,ids:void 0,productList:[],info:{express_name:void 0,express_mobile:void 0},totalFee:0}},created:function(){var t=this.$route.query.ids;if(!t)return this.$message.error("请先选择要购买的产品！"),void this.$router.push("/production");this.ids=t,this.render()},methods:{render:function(){var t=this;Object(c["m"])({ids:this.ids}).then((function(e){var s=(e.data||[]).concat(u);t.productList=s.map((function(t){return t.amount=1,t})),t.computeTotalFee()}))},submit:function(){var t=this;if(this.amount)if(this.info.express_name&&this.info.express_mobile)if(/^1[3456789]\d{9}$/.test(this.info.express_mobile)){var e=this.productList.filter((function(t){return t.total_price})).map((function(t){return{id:t.id,quantity:t.amount}}));this.loading=!0,Object(c["a"])(Object(r["a"])({info:e},this.info)).then((function(e){t.loading=!1,t.$message.success("购买成功！"),t.$router.push("/mine/order")})).catch((function(e){t.loading=!1,t.$message.error(e||"购买失败，请稍后再试！")}))}else this.$message.error("手机号不合法！");else this.$message.error("请输入收货人信息！");else this.$message.error("请输入购买的集群数量！")},handleDelete:function(t){if(2!==this.productList.length){var e=[];this.productList.forEach((function(s,a){String(s.id)!==String(t.id)&&e.push(s)})),this.productList=e,this.computeTotalFee()}else this.$message.error("至少要购买一个产品！")},computeTotalFee:function(){var t=0;this.productList.forEach((function(e){e.total_price&&(t+=e.total_price*Number(e.amount))})),this.totalFee=t},handleReduce:function(t){var e=Number(t.amount);e-1>0?t.amount=e-1:(this.$message.error("最低数量为 1 ~"),t.amount=1),this.computeTotalFee()},handleAdd:function(t){t.stock&&Number(t.amount)+1>Number(t.stock)?(this.$message.error("数量超出范围 ~"),t.amount=Number(t.stock)):t.amount=Number(t.amount)+1,this.computeTotalFee()},handleAmountChange:function(t){var e=t.amount;if(/^[0-9]+$/.test(e)||(t.amount=e.slice(0,-1)),t.stock&&Number(e)>Number(t.stock))return this.$message.error("数量超出范围 ~"),void(t.amount=Number(t.stock));Number(e)>1e7&&(this.$message.error("数量超出范围 ~"),t.amount=1e7),Number(e)<=0&&(this.$message.error("最低数量为 1 ~"),t.amount=1),this.computeTotalFee()}}},d=l,p=(s("c3de"),s("77c4"),s("2877")),m=Object(p["a"])(d,a,n,!1,null,"3852ca2a",null);e["default"]=m.exports},"5e3a":function(t,e,s){},"77c4":function(t,e,s){"use strict";s("5468")},c3de:function(t,e,s){"use strict";s("5e3a")},d81d:function(t,e,s){"use strict";var a=s("23e7"),n=s("b727").map,r=s("1dde"),i=s("ae40"),o=r("map"),c=i("map");a({target:"Array",proto:!0,forced:!o||!c},{map:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}})},dbb4:function(t,e,s){var a=s("23e7"),n=s("83ab"),r=s("56ef"),i=s("fc6a"),o=s("06cf"),c=s("8418");a({target:"Object",stat:!0,sham:!n},{getOwnPropertyDescriptors:function(t){var e,s,a=i(t),n=o.f,u=r(a),l={},d=0;while(u.length>d)s=n(a,e=u[d++]),void 0!==s&&c(l,e,s);return l}})},e439:function(t,e,s){var a=s("23e7"),n=s("d039"),r=s("fc6a"),i=s("06cf").f,o=s("83ab"),c=n((function(){i(1)})),u=!o||c;a({target:"Object",stat:!0,forced:u,sham:!o},{getOwnPropertyDescriptor:function(t,e){return i(r(t),e)}})}}]);
//# sourceMappingURL=chunk-381e4f5f.f01bc6af.js.map